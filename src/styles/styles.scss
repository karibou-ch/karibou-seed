@import "colors.scss";


body{
  margin-top: 0;
  background: white;
  font-size: 1rem;
  zoom: var(--mdc-theme-body-zoom);
  transform-origin: top left;
}


@import 'kng-responsive.scss';
@import 'kng-awesome.scss';
@import 'kng-custom-mdc-theme.scss';

@import 'kng-theme.scss';
@import 'kng-theme-ribbon.scss';
@import 'kng-root.scss';
@import 'kng-widgets.scss';
@import 'kng-mdc.scss';
@import 'kng-card-skeleton.scss';

:root {

  // ðŸ§­ NAVIGATION - Hauteur navbar fixe
  --mdc-theme-top-bar: 70px;
  --mdc-theme-wrapper-zoom: .33;

  --mdc-theme-font: "Gentium Plus";

  --mdc-theme-karibou-pink: #da1c5c;
  --mdc-theme-karibou-green: #62dd2a;
  --mdc-theme-karibou-yellow: #ffe83d;
  --mdc-theme-colormix: white;
  --mdc-theme-primary: #32b0a0;
  --mdc-theme-primary-light: rgba(227,236, 235, 0.3);

  --mdc-theme-primary-text: white;
  --mdc-theme-text-primary-on-background:#333;
  --mdc-theme-secondary: #028b7a;
  --mdc-theme-secondary-light: rgba(227,236, 235, 0.3);

  --mdc-theme-secondary-text: white;
  --mdc-theme-text-secondary-on-background:#333;

  --mdc-theme-appbar: rgba(227,236, 235, 0.97);
  --mdc-theme-appbar-light: rgba(227,236, 235, 0.3);

  --mdc-theme-appbar-text: rgba(19, 83, 20, 0.97);

  --mdc-theme-primary-dark:white;
  --mdc-theme-primary-dark-text:black;

  --mdc-theme-secondary-dark: initial;
  --mdc-theme-secondary-dark-text: initial;

  // FIXME remove this hardcoding
  --mdc-theme-text-hint-on-background:#333;
  --mdc-theme-text-icon-on-background:#333;

  //
  // BODY
  --mdc-theme-background-container: white;

  @supports (color: color-mix(in srgb, red 50%, blue)) {
    --mdc-theme-primary-light:color-mix(in srgb, var(--mdc-theme-primary) 30%, var(--mdc-theme-colormix));
    --mdc-theme-secondary-light:color-mix(in srgb, var(--mdc-theme-secondary) 30%, var(--mdc-theme-colormix));
    --mdc-theme-appbar-light:color-mix(in srgb, var(--mdc-theme-appbar) 30%, var(--mdc-theme-colormix));
  }

  .theme-gradient {
    background:
      radial-gradient(circle at top left, var(--mdc-theme-appbar) 0%, transparent 60%),
      radial-gradient(circle at top right, var(--mdc-theme-secondary-light) 0%, transparent 50%),
      radial-gradient(ellipse at bottom, var(--mdc-theme-secondary-light) 0%, transparent 60%);
    background-color: var(--mdc-theme-appbar-light);
  }


  /** theme colors
  //
  // Artamis
  --mdc-theme-primary: #a21544;
  --mdc-theme-primary-text: white;
  --mdc-theme-secondary: #074840;
  --mdc-theme-secondary-text: rgba(250, 250, 250, 0.97);
  --mdc-theme-appbar: #03ab97;
  --mdc-theme-appbar-text: rgba(250, 250, 250, 0.97)

  //
  // De Janvier Ã  Mars (Montagne & neige)
  --mdc-theme-primary: #5C6B73
  --mdc-theme-primary-text: #FFFFFF
  --mdc-theme-secondary: #8A7A5E
  --mdc-theme-secondary-text: #FFFFFF
  --mdc-theme-appbar: #D9E2D5
  --mdc-theme-appbar-text: #3A4038

  //
  // Halle de Rive (HDR)
  --mdc-theme-primary: #726658;
  --mdc-theme-primary-text: white;
  --mdc-theme-secondary: #890822;
  --mdc-theme-secondary-text: white;
  --mdc-theme-appbar: rgba(236, 230, 223, .95);
  --mdc-theme-appbar-text: #473f30;

  //
  // Superlocal
  --mdc-theme-primary: #32b0a0;
  --mdc-theme-primary-text: black;
  --mdc-theme-secondary: #028b7a;
  --mdc-theme-secondary-text: white;
  --mdc-theme-appbar: rgb(210, 240, 178);
  --mdc-theme-appbar-text: black;

  //
  // Saint-Valentin
  --mdc-theme-primary: #A43355;
  --mdc-theme-primary-text: #000000;
  --mdc-theme-secondary: #A71E47;
  --mdc-theme-secondary-text: #FFFFFF;
  --mdc-theme-appbar: #EFACC0;
  --mdc-theme-appbar-text: #000000;
  */

}



.StripeElement {
  >div {
    width: 100%;
  }
}

kng-news a {
  text-decoration: none;
}


//
// input iOS
textarea,
input.text,
input[type="text"],
input[type="button"],
input[type="submit"],
.input-checkbox {
  -webkit-appearance: none;
  appearance: none;
  border-radius: 0;
}


// ============================================================================
// GRID CONTAINER 3 COLONNES - Layout Principal (STRUCTURE UNIQUEMENT)
// Variables utilisÃ©es :
// - --mdc-theme-top-bar         : Hauteur header (70px)
// - --mdc-theme-toolbox-width   : Largeur max menu side (225px)
// - --mdc-theme-container-width : Largeur center (fixe, responsive)
// - --mdc-theme-right-width     : Largeur max sidebar right (420px)
// - --mdc-theme-body-zoom       : Zoom du body (affecte 100vw)
// ============================================================================

.grid-container-3 {
  display: grid;
  width: 100%;
  min-height: 100dvh;
  gap: 0;

  // DESKTOP (â‰¥1200px) - 4 colonnes (side, center, custom, right)
  // Side et Right prennent le reste de l'espace (1fr)
  // Center a une taille fixe, Custom facultatif (0 ou auto)
  grid-template-columns:1fr var(--mdc-theme-container-width) 1fr;
  grid-template-rows: var(--mdc-theme-top-bar) 1fr auto;
  grid-template-areas:
    "header header header header"
    "side   center custom right"
    "footer footer footer footer";

  // Header
  > .grid-header {
    grid-area: header;
    grid-column: 1 / -1;
    position: sticky;
    top: 0;
    z-index: 10;
  }

  // Wrapper - sous-grid pour les 3 colonnes
  > .mobile-columns-wrapper {
    grid-column: 1 / -1;
    grid-row: 2;
    display: grid;
    grid-template-columns: subgrid;
    // NOTE: overflow: hidden a Ã©tÃ© supprimÃ© car il empÃªche position: sticky
    // des Ã©lÃ©ments enfants (ex: menu-panel sticky). Les Ã©lÃ©ments sticky
    // nÃ©cessitent un ancÃªtre scrollable direct, overflow:hidden casse ce
    // comportement en crÃ©ant un nouveau contexte de scroll.

    > * { display: contents; } // Composant enfant transparent
  }

  // Footer
  > .grid-footer {
    grid-area: footer;
    grid-column: 1 / -1;
  }

  // PANELS - Desktop (structure uniquement)
  .swipe-panel {
    // NOTE: overflow-y: auto dÃ©sactivÃ© car il empÃªche position: sticky
    // des Ã©lÃ©ments enfants. Le scroll vertical est gÃ©rÃ© au niveau body/html.
    // Activer overflow-y crÃ©e un nouveau contexte de scroll qui casse le
    // comportement sticky (ex: menu-panel sticky).

    &.side {
      grid-column: 1;
      display: flex;
      flex-direction: column;
      align-items: flex-end; // Contenu alignÃ© Ã  droite
    }

    &.center {
      grid-column: 2;
    }

    &.custom {
      grid-column: 4;
      display: none; // MasquÃ© par dÃ©faut en desktop

      &:not(:empty) {
        display: block; // Affiche seulement si contenu
      }
    }

    &.right {
      grid-column: 3;
      display: flex;
      flex-direction: column;
      align-items: flex-start; // Contenu alignÃ© Ã  gauche
    }
  }

  // MOBILE (â‰¤599px) - Swipe horizontal 3 Ã— 100vw
  // FIXME: Option 2 - Remplacer scroll-snap par des transitions CSS avec
  // transform: translateX(-100vw), contrÃ´lÃ©es par JavaScript pour le geste swipe.
  // Avantage: Le body redevient le "scrolling ancestor", position: sticky fonctionne.
  // Actuel: overflow-x: auto crÃ©e un contexte de scroll qui casse le sticky natif.
  // Contournement: Sticky simulÃ© via translateY() dans kng-home.component.ts
  @media (max-width: 599px) {
    width: 100vw;
    grid-template-columns: 1fr;
    grid-template-rows: var(--mdc-theme-top-bar) 1fr 60px;

    > .mobile-columns-wrapper {
      display: grid;
      grid-template-columns: repeat(3, 100vw);  // 3 colonnes: side, center, right
      overflow-x: auto;  // âš ï¸ Casse position: sticky des enfants
      scroll-snap-type: x mandatory;
      scroll-snap-stop: always;     // âœ… PHASE 1: Force l'arrÃªt sur CHAQUE panel
      scroll-behavior: smooth;      // Transitions fluides lors du snap
      touch-action: pan-x;          // âœ… PHASE 1: Limite au scroll horizontal seulement
      overscroll-behavior-x: contain; // âœ… PHASE 1: EmpÃªche le rebond horizontal
      scrollbar-width: none;
      &::-webkit-scrollbar { display: none; }

      &.zoomed {
        zoom: var(--mdc-theme-wrapper-zoom);
        align-items: center;
      }


    }

    .swipe-panel {
      // Grid gÃ¨re dÃ©jÃ  la largeur via grid-template-columns
      min-width: 100vw;             // Force minimum 100vw
      max-width: 100vw;             // Force maximum 100vw
      height: 100%;                 // Hauteur fixe
      // NOTE: overflow-x: hidden est CRUCIAL pour le snap prÃ©cis !
      // Sans lui, les marges internes des composants (ex: kng-search.home margin: 20px 10px)
      // crÃ©ent un "espace de libertÃ©" qui permet un scroll horizontal AVANT le snap,
      // causant un dÃ©calage entre swipe gauche (direct) et swipe droite (avec jeu).
      overflow-x: hidden;           // EmpÃªche le scroll horizontal interne
      overflow-y: auto;
      scroll-snap-align: center;    // âœ… PHASE 1: Centrage pour plus de prÃ©cision
      scroll-snap-stop: always;     // âœ… PHASE 1: Force l'arrÃªt sur chaque panel (double sÃ©curitÃ©)
      box-sizing: border-box;       // Padding inclus dans la largeur
      display: block;
      align-items: initial;
      padding: 0;                   // Reset padding desktop

      // Padding sur le contenu interne, pas sur le panel
      > * {
        width: calc(100% - 2rem);   // Largeur moins padding
        padding: 0 1rem;            // Padding horizontal
        max-width: none;
      }
    }

    > .grid-footer {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      z-index: 10;
    }
  }

  // TABLET (600px - 1199px) - Swipe horizontal comme mobile
  @media (min-width: 600px) and (max-width: 1199px) {
    width: 100vw;
    grid-template-columns: 1fr;
    grid-template-rows: var(--mdc-theme-top-bar) 1fr 60px;

    > .mobile-columns-wrapper {
      display: grid;
      grid-template-columns: repeat(3, 100vw);  // 3 colonnes pour swipe
      overflow-x: auto;
      overflow-y: hidden;
      scroll-snap-type: x mandatory;
      scroll-snap-stop: always;     // âœ… PHASE 1: Force l'arrÃªt sur CHAQUE panel
      scroll-behavior: smooth;
      touch-action: pan-x;          // âœ… PHASE 1: Limite au scroll horizontal seulement
      overscroll-behavior-x: contain; // âœ… PHASE 1: EmpÃªche le rebond horizontal
      scrollbar-width: none;
      &::-webkit-scrollbar { display: none; }

      &.zoomed {
        zoom: var(--mdc-theme-wrapper-zoom);
        align-items: center;
      }
    }

    .swipe-panel {
      width: 100vw;
      scroll-snap-align: center;    // âœ… PHASE 1: Centrage pour plus de prÃ©cision
      scroll-snap-stop: always;     // âœ… PHASE 1: Force l'arrÃªt sur chaque panel
      box-sizing: border-box;
      padding: 1rem;
      display: block;
      align-items: initial;

      > * {
        width: 100%;
        padding: 0;
        max-width: none;
      }
    }

    > .grid-footer {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      z-index: 10;
    }
  }
}

// ============================================================================
// INDICATEURS DE SWIPE (points de navigation mobile)
// ============================================================================
.swipe-indicators {
  display: none;

  @media (max-width: 599px) {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 1rem;
    padding: 0.5rem;
    background: transparent;

    .indicator {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background-color: #ccc;
      border: none;
      padding: 0;
      cursor: pointer;
      transition: all 0.2s ease;

      &.active {
        background-color: var(--mdc-theme-primary);
        transform: scale(1.3);
      }
    }
  }
}
