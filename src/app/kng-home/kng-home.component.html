
<!-- ============================================================================ -->
<!-- PANEL SIDE - Menu de navigation (catÃ©gories, liens)                         -->
<!-- ============================================================================ -->
<div class="swipe-panel side">

  <!-- NAVIGATION core (menu catÃ©gories) -->
  <!-- FIXME: Sticky simulÃ© via translateY, voir Option 2 dans kng-home.component.ts -->
  <div class="home menu-panel"
       [hidden]="isMinimal"
       [style.transform]="'translateY(' + menuStickyTransform + 'px)'">

    <!-- MOBILE links -->
    <ul class="subs">
      <!-- FAVORITE -->
      <li class="subs-item inverted" (click)="onFavorites()">
        <i class="material-symbols-outlined">favorite</i>
        <span>{{label.search_bookmark}}</span>
      </li>

      <!-- CUSTOM LINK -->
      <li *ngIf="hub.home.customLink.url" class="subs-item inverted" [routerLink]="hub.home.customLink.url">
        <i class="material-symbols-outlined icon">person_celebrate</i>
        <span>{{hub.home.customLink.label[locale]}}</span>
      </li>

      <li *ngIf="!hub.home.customLink.url" class="subs-item inverted" [routerLink]="['/store',store,'home','business']" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
        <i class="material-symbols-outlined icon">person_celebrate</i>
        <span>{{label.nav_subscription_b2b}}</span>
      </li>

      <!-- SUBSCRIPTION b2c/b2b-->
      <li class="subs-item inverted" [routerLink]="['/store',store,'subscriptions']" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
        <i class="material-symbols-outlined icon">update</i>
        <span>{{label.nav_subscription}}</span>
      </li>

      <!-- JAMES b2c/school -->
      <li *ngIf="!isB2BSchool" class="subs-item inverted" [routerLink]="['/store',store,'assistant','james']" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
        <i class="material-symbols-outlined icon">smart_toy</i>
        <span>{{label.james_title_cta}}</span>
      </li>
      <li *ngIf="isB2BSchool" class="subs-item inverted" [routerLink]="['/store',store,'assistant','james']" [queryParams]="{prompt:label.james_school}" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
        <i class="material-symbols-outlined icon">smart_toy</i>
        <span>{{label.james_school}}</span>
      </li>
    </ul>

    <!-- DESKTOP LINKS -->
    <ul class="hide-sm">
      <li [routerLink]="userRouterLink">
        <span class="fa icon hide">ðŸ‘¦</span>
        <b>{{isAuthencated?label.nav_account:label.nav_login}}</b>
      </li>
      <li [routerLink]="hub.home.customLink.url" [hidden]="!hub.home.customLink.url">
        <b>{{hub.home.customLink.label[locale]}}</b>
      </li>
      <li [routerLink]="'/store/'+store+'/home/business'" [hidden]="hub.home.customLink.url">
        <b>{{label.nav_subscription_b2b}}</b>
      </li>
      <li [routerLink]="'/store/'+store+'/subscriptions'">
        <b>{{label.nav_subscription}}</b>
      </li>
      <li [hidden]="!isAuthencated || !isB2BSchool" [routerLink]="['/store',store,'home','assistant','james']" [queryParams]="{prompt:label.james_school}" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
        <b>{{label.james_school}}</b>
      </li>
      <li class="separator" [routerLink]="['/store',store,'home','assistant','james']" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
        <b>{{label.james_title_cta}}</b>
      </li>
    </ul>

    <!-- CATEGORY on mobile+desktop -->
    <ul class="">
      <li (click)="scrollToSlug(category.slug)" class="subs-item"
          [id]="'category-'+j"
          [class.selected]="category.slug == displaySlug"
          [class.has-image]="hasCategoryImage(category)"
          [style.--cat-image]="hasCategoryImage(category) ? 'url(' + category.cover + ')' : null"
          *ngFor="let category of sortedCategories;let j=index">
        <i [class]="category.image" class="icon hide-md hide-lg"></i>
        <span class="category-label">{{getCategoryI18n(category)}}</span>
      </li>
    </ul>
  </div>

</div>

<!-- ============================================================================ -->
<!-- PANEL CENTER - Contenu principal (produits, calendrier)                     -->
<!-- ============================================================================ -->
<div class="swipe-panel center">

  <!-- INFORMATION HEADER -->
  <div class="home-header" [hidden]="!hub.header.active">
    <img [src]="tagline.image" [hidden]="!tagline.image"/>
    <figure [innerHtml]="hub.header.message[locale]"></figure>
  </div>

  <!-- PINNED PRODUCTS (isMinimal for b2b-school) -->
  <kng-product-swipe class="boost theme-gradient" *ngIf="!isMinimal" [user]="user" [boost]="true" [hub]="store"></kng-product-swipe>

  <!-- MOBILE SEARCH  [hidden]="isMinimal"  use right panel for search -->
  <kng-search class="home" hidden [themes]="themes" [class.active]="availableSearch"></kng-search>

  <!-- PRODUCTS -->
  <div class="product-container" *ngIf="products.length">
    <kng-product-grouped-list clazz="{{products.length<10?'large':''}}"
         [useMaxCat]="products.length>40"
         [alphasort]="false"
         [displayVendor]="true"
         [showMore]="products.length>10"
         [config]="config"
         [user]="user"
         [contentCategories]="sortedCategories"
         [contentProducts]="products"
         [scrollToSlug]="categorySlug"
         (currentCategory)="displaySlug=($event || displaySlug)"
         (direction)="scrollDirection=$event">
    </kng-product-grouped-list>
  </div>


</div>

<!-- <div class="swipe-panel custom"></div> -->

<!-- ============================================================================ -->
<!-- PANEL RIGHT - Sidebar (aide, recherche, infos)                              -->
<!-- ============================================================================ -->
<div class="swipe-panel right">

  <div class="home sidebar-panel" [style.transform]="'translateY(' + menuStickyTransform + 'px)'">
  <!-- CALENDAR -->
  <kng-calendar [user]="user" [title]="theme.name" [hidden]="availableSearch" [config]="config" (updated)="onSetCurrentShippingDay($event)"></kng-calendar>

  <!-- NEED HELP? -->
  <div class="kng-boxed first">
    <div class="content">
      <div class="items" [innerHtml]="hub.description[locale]"></div>
      <div class="bottom">
        <a class="phone" href="tel:{{hub.address.phone}}">
          <i class="material-symbols-outlined icon">phone</i>&nbsp;{{label.nav_help}}
        </a>
      </div>
    </div>
  </div>


    <!-- AUDIO SUPPORT -->
    <div class="kng-boxed first">
      <div class="content">
        <kng-audio-note-enhanced
          type="support"
          [locale]="locale"
          [compact]="true"
          [key]="config.shared.keys.pubUpcare"
          filename="support-ticket-home"
          (onAudioReady)="onAudioStopAndSave($event)"
          (onAudioError)="onAudioError($event)">
          <div slot="header-compact">
            <p>
              {{ label.audio_support_contact }}
              <a hidden class="show-sm" href="tel:{{hub.address.phone}}">(tÃ©lÃ©phone)</a>
            </p>
          </div>
        </kng-audio-note-enhanced>
      </div>
      <div class="bottom" [hidden]="!audioContext?.audioUrl">
        <button class="width-100 default small secondary" (click)="onSendAudioNote()">
          {{ label.audio_support_send }}
        </button>
      </div>
    </div>

    <!-- SEARCH BAR [hidden]="isMinimal" use right panel for search -->
    <kng-search-bar  [themes]="themes" [class.active]="availableSearch"></kng-search-bar>
  </div>

</div>


  <!-- ROUTER OUTLET -->
  <router-outlet></router-outlet>
